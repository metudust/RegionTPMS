(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     51533,       1171]
NotebookOptionsPosition[     50110,       1138]
NotebookOutlinePosition[     50584,       1156]
CellTagsIndexPosition[     50541,       1153]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["REGION BASED TRIPLY PERIODIC MINIMAL SURFACES (TPMS)", "Subtitle",
 CellChangeTimes->{{3.8157246208001738`*^9, 3.815724641135215*^9}, {
  3.8157246873481784`*^9, 3.8157247070101767`*^9}, {3.8180618413608403`*^9, 
  3.8180618416931376`*^9}, {3.824649351141981*^9, 
  3.8246493802559805`*^9}},ExpressionUUID->"08c1aa37-dece-409a-883a-\
d9d4505cfe99"],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox[
  RowBox[{"TPMS", " ", "FUNCTIONS"}], "Subsubsection"]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.8218023452222195`*^9, 3.8218023454932504`*^9}, 
   3.82180276066444*^9, 3.8218062352171907`*^9, {3.8218075494833584`*^9, 
   3.8218075501763825`*^9}, {3.8218081178510475`*^9, 3.821808148498777*^9}, {
   3.821808204746153*^9, 3.8218082243433084`*^9}, {3.821808296568798*^9, 
   3.821808299382576*^9}, {3.8218084409534464`*^9, 3.821808468243929*^9}, 
   3.821811879830187*^9, {3.8218124896014376`*^9, 3.821812517572438*^9}, {
   3.8218125670241127`*^9, 3.821812619427492*^9}, 3.8218126535159616`*^9, {
   3.8218127479488335`*^9, 3.8218127526499777`*^9}, {3.8218131234272523`*^9, 
   3.82181312437426*^9}, {3.821865441991607*^9, 3.82186545193657*^9}, {
   3.821865622868692*^9, 3.821865626626671*^9}, {3.8218656605196524`*^9, 
   3.821865667172651*^9}, {3.824649393082983*^9, 
   3.8246493937379923`*^9}},ExpressionUUID->"6aba2b60-86f6-4f37-b4aa-\
91c1188190ae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Root", " ", 
    RowBox[{"finding", ":", " ", 
     RowBox[{"Bisection", " ", "method"}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "@", "bisection"}], "=", 
   RowBox[{"{", "HoldAll", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"bisection", "::", "nochangeofsign"}], "=", 
   "\"\<sign does not change, try other bounds\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "bisection"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"AccuracyGoal", "\[Rule]", 
      RowBox[{"$MachinePrecision", "/", "2"}]}], ",", 
     RowBox[{"Rational", "\[Rule]", "False"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Clear", "@", "bisection"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "contourRegionPlot3D", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"bisection", "[", 
    RowBox[{"expr_", ",", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "x1_", ",", "x2_"}], "}"}], ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"f1", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"x", ",", "#"}], "]"}], "&"}], "@", "expr"}]}], "}"}], ",", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"s", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"LessEqual", "@@", "#"}], ",", "1", ",", 
             RowBox[{"GreaterEqual", "@@", "#"}], ",", 
             RowBox[{"-", "1"}], ",", "True", ",", 
             RowBox[{"Message", "@", 
              RowBox[{"bisection", "::", "nochangeofsign"}]}]}], "]"}], "&"}],
           "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"f1", "@", "x1"}], ",", "0", ",", 
            RowBox[{"f1", "@", "x2"}]}], "}"}]}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"OptionValue", "@", "Rational"}]}], ",", "1.", ",", "1"}], 
         "]"}], " ", 
        RowBox[{"First", "@", 
         RowBox[{"NestWhile", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"s", " ", 
                  RowBox[{"f1", "@", "#2"}]}], ">", "0"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"First", "@", "#"}], ",", "#2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"#2", ",", 
                  RowBox[{"Last", "@", "#"}]}], "}"}]}], "]"}], "&"}], "[", 
             RowBox[{"#", ",", 
              RowBox[{
               RowBox[{"Total", "@", "#"}], "/", "2"}]}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "x2"}], "}"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"First", "@", "#"}], "-", 
               RowBox[{"Last", "@", "#"}]}], "]"}], ">", 
             RowBox[{"Power", "[", 
              RowBox[{"10", ",", 
               RowBox[{"-", 
                RowBox[{"OptionValue", "@", "AccuracyGoal"}]}]}], "]"}]}], 
            "&"}]}], "]"}]}]}]}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"contourRegionPlot3D", "[", 
    RowBox[{"region_", ",", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "x0_", ",", "x1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y_", ",", "y0_", ",", "y1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z_", ",", "z0_", ",", "z1_"}], "}"}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reg", ",", "preds"}], "}"}], ",", 
     RowBox[{
      RowBox[{"reg", "=", 
       RowBox[{"LogicalExpand", "[", 
        RowBox[{"region", "&&", 
         RowBox[{"x0", "\[LessEqual]", "x", "\[LessEqual]", "x1"}], "&&", 
         RowBox[{"y0", "\[LessEqual]", "y", "\[LessEqual]", "y1"}], "&&", 
         RowBox[{"z0", "\[LessEqual]", "z", "\[LessEqual]", "z1"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"preds", "=", 
       RowBox[{"Union", "@", 
        RowBox[{"Cases", "[", 
         RowBox[{"reg", ",", 
          RowBox[{
          "_Greater", "|", "_GreaterEqual", "|", "_Less", "|", "_LessEqual"}],
           ",", 
          RowBox[{"-", "1"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Show", "@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ContourPlot3D", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"Equal", "@@", "p"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "x0", ",", "x1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", "y0", ",", "y1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"z", ",", "z0", ",", "z1"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"RegionFunction", "\[Rule]", 
            RowBox[{"Function", "@@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
               RowBox[{
                RowBox[{"Refine", "[", 
                 RowBox[{"reg", ",", "p"}], "]"}], "&&", 
                RowBox[{"Refine", "[", 
                 RowBox[{
                  RowBox[{"!", "reg"}], ",", 
                  RowBox[{"!", "p"}]}], "]"}]}]}], "}"}]}]}], ",", 
           RowBox[{"RegionBoundaryStyle", "\[Rule]", "None"}], ",", "opts"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"p", ",", "preds"}], "}"}]}], "]"}]}]}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Schoen", ",", " ", "2012", ",", " ", 
    RowBox[{
     RowBox[{"Reflections", " ", "concerning", " ", "triply"}], "-", 
     RowBox[{"periodic", " ", "minimal", " ", "surfaces"}]}]}], " ", "*)"}], 
  "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"https", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"www", ".", "msri", ".", "org"}], "/", "publications"}], 
          "/", "sgp"}], "/", "jim"}], "/", "papers"}], "/", 
       "morphbysymmetry"}], "/", "splitp"}], "/", 
     RowBox[{"main", ".", "html"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"http", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{"dx", ".", "doi", ".", "org"}], "/", "10.1021"}], "/", 
     "ma0019499"}]}], "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"http", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"dx", ".", "doi", ".", "org"}], "/", "10.1088"}], "/", 
      "1758"}], "-", 
     RowBox[{"5090", "/", "aa6553"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"http", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"dx", ".", "doi", ".", "org"}], "/", "10.1103"}], "/", 
      "PhysRevB"}], ".68", ".115107"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Schwarz", " ", "D"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"diamond", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", "x", "]"}], 
      RowBox[{"Sin", "[", "y", "]"}], 
      RowBox[{"Sin", "[", "z", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", "x", "]"}], 
      RowBox[{"Cos", "[", "y", "]"}], 
      RowBox[{"Cos", "[", "z", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", "x", "]"}], 
      RowBox[{"Sin", "[", "y", "]"}], 
      RowBox[{"Cos", "[", "z", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", "x", "]"}], 
      RowBox[{"Cos", "[", "y", "]"}], 
      RowBox[{"Sin", "[", "z", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Schwarz", " ", "G"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gyroid", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "x", "]"}], 
      RowBox[{"Sin", "[", "y", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", "y", "]"}], 
      RowBox[{"Sin", "[", "z", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", "z", "]"}], 
      RowBox[{"Sin", "[", "x", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Schwarz", " ", "P"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"schwarzp", "=", 
    RowBox[{
     RowBox[{"Cos", "[", "x", "]"}], "+", 
     RowBox[{"Cos", "[", "y", "]"}], "+", 
     RowBox[{"Cos", "[", "z", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fischer", "-", 
    RowBox[{"Koch", " ", "S"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fisherkochs", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"2", "x"}], "]"}], 
      RowBox[{"Sin", "[", "y", "]"}], 
      RowBox[{"Cos", "[", "z", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"2", "y"}], "]"}], 
      RowBox[{"Sin", "[", "z", "]"}], 
      RowBox[{"Cos", "[", "x", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"2", "z"}], "]"}], 
      RowBox[{"Sin", "[", "x", "]"}], 
      RowBox[{"Cos", "[", "y", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Fischer", "-", 
    RowBox[{"Koch", " ", "Y"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fisherkochy", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "x", "]"}], 
      RowBox[{"Cos", "[", "y", "]"}], " ", 
      RowBox[{"Cos", "[", "z", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", "x", "]"}], 
      RowBox[{"Sin", "[", "y", "]"}], 
      RowBox[{"Sin", "[", "z", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"2", "x"}], "]"}], 
      RowBox[{"Sin", "[", "y", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"2", "y"}], "]"}], 
      RowBox[{"Sin", "[", "z", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", "x", "]"}], 
      RowBox[{"Sin", "[", 
       RowBox[{"2", "z"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"2", "x"}], "]"}], 
      RowBox[{"Cos", "[", "z", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", "x", "]"}], 
      RowBox[{"Sin", "[", 
       RowBox[{"2", "y"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", "y", "]"}], 
      RowBox[{"Sin", "[", 
       RowBox[{"2", "z"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "Lidinoid", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lidinoid", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"2", "x"}], "]"}], 
      RowBox[{"Cos", "[", "y", "]"}], 
      RowBox[{"Sin", "[", "z", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"2", "y"}], "]"}], 
      RowBox[{"Cos", "[", "z", "]"}], 
      RowBox[{"Sin", "[", "x", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"2", "z"}], "]"}], 
      RowBox[{"Cos", "[", "x", "]"}], 
      RowBox[{"Sin", "[", "y", "]"}]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"2", "x"}], "]"}], 
      RowBox[{"Cos", "[", 
       RowBox[{"2", "y"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"2", "y"}], "]"}], 
      RowBox[{"Cos", "[", 
       RowBox[{"2", "z"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"2", "z"}], "]"}], 
      RowBox[{"Cos", "[", 
       RowBox[{"2", "x"}], "]"}]}], "+", "0.3"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Split", "-", "P"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"splitp", "=", 
    RowBox[{
     RowBox[{"1.1", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"2", "x"}], "]"}], 
         RowBox[{"Sin", "[", "z", "]"}], 
         RowBox[{"Cos", "[", "y", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"2", "y"}], "]"}], 
         RowBox[{"Sin", "[", "x", "]"}], 
         RowBox[{"Cos", "[", "z", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"2", "z"}], "]"}], 
         RowBox[{"Sin", "[", "y", "]"}], 
         RowBox[{"Cos", "[", "x", "]"}]}]}], ")"}]}], "-", 
     RowBox[{"0.2", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"2", "x"}], "]"}], 
         RowBox[{"Cos", "[", 
          RowBox[{"2", "y"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"2", "y"}], "]"}], 
         RowBox[{"Cos", "[", 
          RowBox[{"2", "z"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"2", "z"}], "]"}], "*", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", "x"}], "]"}]}]}], ")"}]}], "-", 
     RowBox[{"0.4", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"2", "x"}], "]"}], "+", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", "y"}], "]"}], "+", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", "z"}], "]"}]}], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "Neovius", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"neovius", "=", 
    RowBox[{
     RowBox[{"3", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cos", "[", "x", "]"}], "+", 
        RowBox[{"Cos", "[", "y", "]"}], "+", 
        RowBox[{"Cos", "[", "z", "]"}]}], ")"}]}], "+", 
     RowBox[{"4", 
      RowBox[{"Cos", "[", "x", "]"}], 
      RowBox[{"Cos", "[", "y", "]"}], 
      RowBox[{"Cos", "[", "z", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"I", "-", 
    RowBox[{"WP", " ", "surface"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"iwp", "=", 
    RowBox[{
     RowBox[{"2", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "x", "]"}], 
         RowBox[{"Cos", "[", "y", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", "y", "]"}], 
         RowBox[{"Cos", "[", "z", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", "z", "]"}], 
         RowBox[{"Cos", "[", "x", "]"}]}]}], ")"}]}], "-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"2", "x"}], "]"}], "+", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", "y"}], "]"}], "+", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", "z"}], "]"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"F", "-", 
    RowBox[{"RD", " ", "surface"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"frd", "=", 
    RowBox[{
     RowBox[{"4", " ", 
      RowBox[{"Cos", "[", "x", "]"}], " ", 
      RowBox[{"Cos", "[", "y", "]"}], " ", 
      RowBox[{"Cos", "[", "z", "]"}]}], "-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "x"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "y"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "y"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "z"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "z"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "x"}], "]"}]}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"funcmin", ",", "funcmax", ",", "region", ",", "volumemax"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"funcmin", "[", 
    RowBox[{
    "fun_", ",", "xmin_", ",", "xmax_", ",", "ymin_", ",", "ymax_", ",", 
     "zmin_", ",", "zmax_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"FindMinimum", "[", 
     RowBox[{"fun", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "xmin", ",", "xmax"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", "ymin", ",", "ymax"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", "zmin", ",", "zmax"}], "}"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"funcmax", "[", 
    RowBox[{
    "fun_", ",", "xmin_", ",", "xmax_", ",", "ymin_", ",", "ymax_", ",", 
     "zmin_", ",", "zmax_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"FindMaximum", "[", 
     RowBox[{"fun", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "xmin", ",", "xmax"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", "ymin", ",", "ymax"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", "zmin", ",", "zmax"}], "}"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"region", "[", 
    RowBox[{"fun_", ",", "funcmin_", ",", "funcmax_", ",", "boundary_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"funcmin", "\[LessEqual]", "fun", "\[LessEqual]", "funcmax"}], "&&",
     "boundary"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"volumemax", "[", 
    RowBox[{
    "fun_", ",", "funcmin_", ",", "funcmax_", ",", "boundary_", ",", "xmin_", 
     ",", "xmax_", ",", "ymin_", ",", "ymax_", ",", "zmin_", ",", "zmax_"}], 
    "]"}], ":=", 
   RowBox[{"Quiet", "[", 
    RowBox[{"Chop", "[", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{"Boole", "[", 
        RowBox[{"region", "[", 
         RowBox[{"fun", ",", "funcmin", ",", "funcmax", ",", "boundary"}], 
         "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "xmin", ",", "xmax"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "ymin", ",", "ymax"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", "zmin", ",", "zmax"}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", "\"\<MonteCarlo\>\""}], ",", 
       RowBox[{"WorkingPrecision", "\[Rule]", "5"}]}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.8218023452222195`*^9, 3.8218023454932504`*^9}, 
   3.82180276066444*^9, 3.8218062352171907`*^9, {3.8218075494833584`*^9, 
   3.8218075501763825`*^9}, {3.8218081178510475`*^9, 3.821808148498777*^9}, {
   3.821808204746153*^9, 3.8218082243433084`*^9}, {3.821808296568798*^9, 
   3.821808299382576*^9}, {3.8218084409534464`*^9, 3.821808468243929*^9}, 
   3.821811879830187*^9, {3.8218124896014376`*^9, 3.821812517572438*^9}, {
   3.8218125670241127`*^9, 3.821812619427492*^9}, 3.8218126535159616`*^9, {
   3.8218127479488335`*^9, 3.8218127526499777`*^9}, {3.8218131234272523`*^9, 
   3.82181312437426*^9}, {3.821865441991607*^9, 3.82186545193657*^9}, {
   3.821865622868692*^9, 3.821865626626671*^9}, {3.8218656605196524`*^9, 
   3.821865667172651*^9}, {3.82186570384565*^9, 3.8218657151646795`*^9}, {
   3.8218657787541533`*^9, 3.8218658564161544`*^9}, {3.821866004134371*^9, 
   3.8218660143723583`*^9}, {3.82186604911447*^9, 3.821866172164411*^9}, {
   3.821866311193223*^9, 3.821866362200225*^9}, {3.8218665462520275`*^9, 
   3.8218665540820293`*^9}, {3.821866740516137*^9, 3.8218667858570986`*^9}, {
   3.8218695839948997`*^9, 3.8218696220639353`*^9}, {3.821869887004898*^9, 
   3.8218700575989265`*^9}, {3.8218711316105146`*^9, 
   3.8218711912295527`*^9}, {3.8218714552460756`*^9, 3.821871459269096*^9}, {
   3.8218715341750736`*^9, 3.8218715420060787`*^9}, {3.821871588687378*^9, 
   3.821871718831416*^9}, {3.8218719390664077`*^9, 3.8218720815163794`*^9}, {
   3.8218721905753784`*^9, 3.821872245184077*^9}, {3.8218724641790867`*^9, 
   3.8218724716271124`*^9}, {3.821872509382085*^9, 3.8218726415930862`*^9}, {
   3.821872718271106*^9, 3.8218727200260863`*^9}, 3.821872901472197*^9, {
   3.8218729622169657`*^9, 3.821873006658966*^9}, {3.821873911633215*^9, 
   3.8218740661181774`*^9}, {3.8218741330111785`*^9, 
   3.8218742796886873`*^9}, {3.8218743356016836`*^9, 
   3.8218744138107147`*^9}, {3.8218744560197268`*^9, 
   3.8218744611076856`*^9}, {3.8218745039456854`*^9, 
   3.8218745115296836`*^9}, {3.821874565708727*^9, 3.8218745705017414`*^9}, {
   3.821875269917168*^9, 3.821875394725254*^9}, {3.8218758724526005`*^9, 
   3.8218759399746017`*^9}, {3.8218762011764374`*^9, 
   3.8218762048894587`*^9}, {3.821894923425977*^9, 3.8218949298150024`*^9}, {
   3.8218949881799946`*^9, 3.8218950143039913`*^9}, 3.8218964281716385`*^9, {
   3.8219856424730415`*^9, 3.82198568081702*^9}, {3.82198582041201*^9, 
   3.8219858387010136`*^9}, 3.822023041899442*^9, {3.8220232324090643`*^9, 
   3.8220232338330345`*^9}, {3.822033826769678*^9, 3.8220338302897024`*^9}, 
   3.822034165591699*^9, {3.8220347784067907`*^9, 3.822034778745792*^9}, {
   3.8222420911728926`*^9, 3.822242105055601*^9}, {3.822332016906375*^9, 
   3.822332019567464*^9}, {3.822332078644791*^9, 3.822332079162754*^9}, {
   3.8223326277152233`*^9, 3.822332632438261*^9}, {3.822334429092516*^9, 
   3.8223344464175153`*^9}, {3.8223705586492133`*^9, 3.822370607902182*^9}, {
   3.822371502684971*^9, 3.8223715602409716`*^9}, 3.822371629001972*^9, {
   3.822371955007273*^9, 3.82237196632327*^9}, 3.822373344416004*^9, {
   3.8223734734310904`*^9, 3.8223734820480895`*^9}, {3.82241841541444*^9, 
   3.8224184187552547`*^9}, {3.8224185991869698`*^9, 
   3.8224186017035055`*^9}, {3.8224192934505944`*^9, 3.822419298552597*^9}, {
   3.8224569933361945`*^9, 3.822457022503172*^9}, {3.822458334672781*^9, 
   3.8224583944757648`*^9}, {3.822458677192734*^9, 3.8224586798687286`*^9}, {
   3.824649157025979*^9, 3.82464917332498*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"4c5abc6e-b35a-4ee3-87ee-f9c3427e4668"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 StyleBox[
  RowBox[{
  "EXACT", " ", "POROSITY", " ", "SOLVER", " ", "FOR", " ", "SELECTED", " ", 
   "TPMS", " ", "FUNCTION"}], "Subsubsection"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
  "REGION", " ", "BASED", " ", "TPMS", " ", "STL", " ", "GENERATION"}], 
  "Subsubsection"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"VISUAL", " ", "FILE", " ", "GENERATION"}], 
  "Subsubsection"]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 CellChangeTimes->{{3.8218744884626856`*^9, 3.821874490108684*^9}, {
   3.8218745242416844`*^9, 3.821874593428684*^9}, {3.821874754869337*^9, 
   3.8218747551153245`*^9}, {3.8218750234955797`*^9, 
   3.8218750341615467`*^9}, {3.8218752327019696`*^9, 
   3.8218752420611677`*^9}, {3.821875397107546*^9, 3.8218753984365473`*^9}, {
   3.8218757338046722`*^9, 3.8218757344356613`*^9}, {3.821875919522601*^9, 
   3.8218759485916014`*^9}, {3.8218759959982815`*^9, 
   3.8218760640169067`*^9}, {3.821876100736637*^9, 3.8218761779347634`*^9}, {
   3.821876209523437*^9, 3.8218762748199863`*^9}, {3.8218763872095137`*^9, 
   3.8218764130165854`*^9}, {3.8218767677776775`*^9, 3.82187677727521*^9}, {
   3.8218838961658354`*^9, 3.821883912902836*^9}, 3.8218844972518835`*^9, {
   3.821884557077883*^9, 3.8218845587426033`*^9}, 3.821885363163186*^9, {
   3.8218950169119987`*^9, 3.821895022246022*^9}, {3.8218959248894653`*^9, 
   3.8218959575145025`*^9}, {3.8218960161924663`*^9, 3.821896157046632*^9}, 
   3.8218961878256397`*^9, {3.8218963507706385`*^9, 3.8218964134776373`*^9}, {
   3.821896862174019*^9, 3.8218968765990186`*^9}, {3.8218970005750933`*^9, 
   3.821897005480093*^9}, {3.821897055586094*^9, 3.8218970593430967`*^9}, {
   3.8218971432011213`*^9, 3.821897193939093*^9}, {3.8218977501728125`*^9, 
   3.821897764506811*^9}, {3.8218977988173676`*^9, 3.8218978042193146`*^9}, {
   3.821897877320505*^9, 3.821897880788528*^9}, {3.821898099515436*^9, 
   3.821898106509444*^9}, {3.821898290943677*^9, 3.8218982933506684`*^9}, {
   3.821898689737253*^9, 3.8218986898682833`*^9}, {3.821940134532725*^9, 
   3.8219401441177244`*^9}, {3.822023048266965*^9, 3.8220230654426627`*^9}, {
   3.8220338181526723`*^9, 3.822033818232673*^9}, {3.822034160351827*^9, 
   3.822034162169145*^9}, {3.8223320889037914`*^9, 3.8223321267947526`*^9}, {
   3.822332510177253*^9, 3.822332523178224*^9}, {3.8223325722722225`*^9, 
   3.8223325948852243`*^9}, {3.822332896520006*^9, 3.8223329056320105`*^9}, 
   3.8223332639271617`*^9, 3.822333570535222*^9, 3.822333789010659*^9, {
   3.822333971710515*^9, 3.82233397879854*^9}, {3.822334456044538*^9, 
   3.8223344627285585`*^9}, {3.822335072748788*^9, 3.82233511711944*^9}, 
   3.82236341332922*^9, {3.8223637175587997`*^9, 3.822363720098797*^9}, {
   3.8223639086529975`*^9, 3.8223639571633387`*^9}, {3.822363998972376*^9, 
   3.8223640399913673`*^9}, 3.8223642692009983`*^9, {3.8223646963208847`*^9, 
   3.822364703272901*^9}, {3.822368065432886*^9, 3.8223680670518847`*^9}, {
   3.822368306346199*^9, 3.8223683110494432`*^9}, {3.822369641430986*^9, 
   3.822369642328985*^9}, {3.822369882722618*^9, 3.822369885758648*^9}, {
   3.822370134453638*^9, 3.822370141381461*^9}, 3.8223705431022034`*^9, {
   3.822370616085224*^9, 3.822370724450182*^9}, {3.8223707884871836`*^9, 
   3.8223707895672126`*^9}, {3.8223709492962213`*^9, 
   3.8223710221961837`*^9}, {3.822371118210142*^9, 3.822371233336235*^9}, {
   3.8223712782249203`*^9, 3.822371279415921*^9}, {3.822371355287012*^9, 
   3.822371355758972*^9}, {3.822371395945972*^9, 3.8223714018390007`*^9}, {
   3.8223715900990033`*^9, 3.8223716523579426`*^9}, {3.822371709844945*^9, 
   3.8223717164359426`*^9}, {3.8223717864561596`*^9, 
   3.8223718772432613`*^9}, {3.8223719253962665`*^9, 3.822371942225233*^9}, {
   3.8223719817802324`*^9, 3.8223720088702316`*^9}, {3.8223721474292355`*^9, 
   3.8223721583182936`*^9}, {3.8223728354182243`*^9, 3.822372894817263*^9}, {
   3.8223731093338976`*^9, 3.8223731845199294`*^9}, {3.822373281053952*^9, 
   3.822373327292013*^9}, {3.8223733827316074`*^9, 3.8223735524040723`*^9}, {
   3.8223735914220533`*^9, 3.822373594751052*^9}, {3.8223736255320816`*^9, 
   3.8223736419100523`*^9}, 3.8223738185350895`*^9, {3.8223739296423283`*^9, 
   3.8223739476212935`*^9}, 3.822375910234192*^9, {3.822377683883778*^9, 
   3.8223776842218466`*^9}, {3.8223800405947466`*^9, 3.822380055489781*^9}, {
   3.822380207500115*^9, 3.822380207679153*^9}, {3.822380296445128*^9, 
   3.8223803773746963`*^9}, {3.8223804588237357`*^9, 
   3.8223804761987567`*^9}, {3.822380564690699*^9, 3.822380617403717*^9}, {
   3.822380676198735*^9, 3.8223806849277353`*^9}, {3.8223807209967375`*^9, 
   3.822380725021698*^9}, {3.8223810843807354`*^9, 3.8223810876437054`*^9}, {
   3.8223816908795443`*^9, 3.822381691687544*^9}, {3.822382340662259*^9, 
   3.8223823413812714`*^9}, {3.822383617609753*^9, 3.822383619923776*^9}, {
   3.822385834649585*^9, 3.8223858388345747`*^9}, 3.8223862736965175`*^9, 
   3.8224129189249306`*^9, {3.8224132610845995`*^9, 3.8224132656287766`*^9}, {
   3.8224132973760605`*^9, 3.8224132982331095`*^9}, {3.822414828622324*^9, 
   3.822414843090307*^9}, {3.8224154423141165`*^9, 3.8224154802736115`*^9}, {
   3.822415543317973*^9, 3.822415546309658*^9}, {3.822415608725479*^9, 
   3.822415611560072*^9}, {3.8224157107834063`*^9, 3.822415717735783*^9}, 
   3.822415809275481*^9, {3.8224158705410476`*^9, 3.822415879717389*^9}, {
   3.822415977163825*^9, 3.8224159776800866`*^9}, {3.822416121411292*^9, 
   3.822416121664255*^9}, {3.822416202456827*^9, 3.8224162029058657`*^9}, {
   3.822416312262365*^9, 3.8224163246986203`*^9}, {3.8224164127879915`*^9, 
   3.8224164212929974`*^9}, {3.822416635644348*^9, 3.8224166450984983`*^9}, {
   3.8224167306225476`*^9, 3.8224168032059417`*^9}, {3.8224168804718037`*^9, 
   3.822416891114137*^9}, {3.8224169516173997`*^9, 3.8224169549922132`*^9}, {
   3.8224169956960096`*^9, 3.822417006741174*^9}, {3.8224171436779156`*^9, 
   3.8224171485569324`*^9}, {3.8224172512498226`*^9, 
   3.8224172697215605`*^9}, {3.8224173245334034`*^9, 
   3.8224173359642377`*^9}, {3.8224173750457582`*^9, 
   3.8224173760817213`*^9}, {3.8224174941393766`*^9, 3.822417499897397*^9}, {
   3.822417673510089*^9, 3.822417676322049*^9}, {3.82241840689837*^9, 
   3.82241842741848*^9}, {3.822418535171812*^9, 3.822418564217611*^9}, {
   3.8224186693383265`*^9, 3.822418704887393*^9}, {3.8224192743165627`*^9, 
   3.8224192857515564`*^9}, {3.822419332618559*^9, 3.822419362295558*^9}, 
   3.8224565919084253`*^9, {3.82245706944248*^9, 3.822457072869874*^9}, {
   3.8224580519800973`*^9, 3.82245812107806*^9}, 3.822458464184738*^9, {
   3.8224585010377398`*^9, 3.8224585032867775`*^9}, {3.8224586187136955`*^9, 
   3.822458619860696*^9}, {3.822458689970697*^9, 3.8224586902866993`*^9}, 
   3.822458853569829*^9, {3.822458891708813*^9, 3.822458893148777*^9}, 
   3.8224589331618195`*^9, {3.822459101749102*^9, 3.822459128388141*^9}, {
   3.822459243903104*^9, 3.8224592442421327`*^9}, {3.8224595890359783`*^9, 
   3.822459624379983*^9}, {3.8224599356005144`*^9, 3.8224599785305147`*^9}, {
   3.822460702727789*^9, 3.8224607047317905`*^9}, 3.8224623428677435`*^9, 
   3.822462414998578*^9, {3.8224625019633303`*^9, 3.8224625530392933`*^9}, {
   3.822462869997077*^9, 3.822462879964049*^9}, {3.822467152035796*^9, 
   3.8224671573217974`*^9}, {3.8224674333761616`*^9, 
   3.8224674334861917`*^9}, {3.822467967063902*^9, 3.822467967493929*^9}, {
   3.8224684386928816`*^9, 3.822468454754883*^9}, {3.8224695992769094`*^9, 
   3.822469599390908*^9}, {3.8224700796143484`*^9, 3.8224701256273303`*^9}, 
   3.8224701786433496`*^9, 3.82247148040007*^9, {3.8224717082133007`*^9, 
   3.822471708619303*^9}, {3.82247174360734*^9, 3.822471765453306*^9}, {
   3.824649185594984*^9, 3.8246492832609806`*^9}, {3.8246493335959806`*^9, 
   3.8246493742729783`*^9}, {3.824649474377983*^9, 
   3.8246495984410005`*^9}},ExpressionUUID->"745ccf46-2330-44b6-9d11-\
ec1428d321cc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Input", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", "por", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fun", "=", "diamond"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"TPMS", " ", "function"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"porosity", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"0.5", ",", "0.5", ",", "0.1"}], "]"}]}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{"Porosity", " ", "range"}], "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"radius", "=", "10"}], ";", 
    RowBox[{"(*", 
     RowBox[{
     "Domain", " ", "definition", " ", "in", " ", "terms", " ", "of", " ", 
      "radius"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "xmin", ",", "xmax", ",", "ymin", ",", "ymax", ",", "zmin", ",", 
       "zmax"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "radius"}], ",", "radius", ",", 
       RowBox[{"-", "radius"}], ",", "radius", ",", 
       RowBox[{"-", "radius"}], ",", "radius"}], "}"}]}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{"Min", "-", 
      RowBox[{"max", " ", "domain", " ", "range"}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"boundary", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"radius", "^", "2"}], "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x", "^", "2"}], "+", 
         RowBox[{"y", "^", "2"}]}], ")"}]}], "\[GreaterEqual]", "0."}]}], ";",
     " ", 
    RowBox[{"(*", 
     RowBox[{"Cylindrical", " ", "domain"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"boundary", "=", 
       RowBox[{
        RowBox[{"xmin", "\[LessEqual]", "x", "\[LessEqual]", "xmax"}], " ", "&&",
         " ", 
        RowBox[{"ymin", "\[LessEqual]", "y", "\[LessEqual]", "ymax"}]}]}], 
      ";"}], " ", 
     RowBox[{"(*", 
      RowBox[{"Rectangular", " ", "prism", " ", "domain"}], "*)"}], " ", 
     "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"funcminn", "=", 
     RowBox[{"funcmin", "[", 
      RowBox[{
      "fun", ",", "xmin", ",", "xmax", ",", "ymin", ",", "ymax", ",", "zmin", 
       ",", "zmax"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"funcmaxx", "=", 
     RowBox[{"funcmax", "[", 
      RowBox[{
      "fun", ",", "xmin", ",", "xmax", ",", "ymin", ",", "ymax", ",", "zmin", 
       ",", "zmax"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"volumemaxx", "=", 
     RowBox[{"volumemax", "[", 
      RowBox[{
      "fun", ",", "funcminn", ",", "funcmaxx", ",", "boundary", ",", "xmin", 
       ",", "xmax", ",", "ymin", ",", "ymax", ",", "zmin", ",", "zmax"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Porosity", "-", 
     RowBox[{"increment", " ", "correlation", " ", "and", " ", "function"}]}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"por", "[", 
      RowBox[{"increment_", "?", "NumericQ"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"volumemaxx", "-", "\[IndentingNewLine]", 
        RowBox[{"Quiet", "[", 
         RowBox[{"NIntegrate", "[", 
          RowBox[{
           RowBox[{"Boole", "[", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"funcminn", "\[LessEqual]", "fun", "\[LessEqual]", 
               RowBox[{"funcminn", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"funcmaxx", "-", "funcminn"}], ")"}], "*", 
                 "increment"}]}]}], " ", "&&", " ", "boundary"}], ")"}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "xmin", ",", "xmax"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", "ymin", ",", "ymax"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"z", ",", "zmin", ",", "zmax"}], "}"}], ",", 
           RowBox[{"Method", "\[Rule]", "\"\<MonteCarlo\>\""}], ",", 
           RowBox[{"WorkingPrecision", "\[Rule]", "5"}]}], "]"}], "]"}]}], 
       ")"}], "/", "volumemaxx"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"increments", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"bisection", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"por", "[", "incrementguess", "]"}], "-", "porosityval"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"incrementguess", ",", "0.1", ",", "1.1"}], "}"}], ",", 
         RowBox[{"AccuracyGoal", "\[Rule]", "5"}], ",", 
         RowBox[{"Rational", "\[Rule]", "True"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"porosityval", ",", "porosity"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"funcs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"funcminn", "\[LessEqual]", "fun", "\[LessEqual]", 
         RowBox[{"funcminn", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"funcmaxx", "-", "funcminn"}], ")"}], "*", 
           "increment"}]}]}], " ", "&&", " ", "boundary"}], ",", 
       RowBox[{"{", 
        RowBox[{"increment", ",", "increments"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"cylTPMS", "=", 
     RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"RegionPlot3D", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"funcs", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"x", ",", "xmin", ",", "xmax"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", "ymin", ",", "ymax"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"z", ",", "zmin", ",", "zmax"}], "}"}], ",", 
         "\[IndentingNewLine]", " ", 
         RowBox[{"PlotPoints", "\[Rule]", "100"}], ",", " ", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"Opacity", "[", "0.8", "]"}], ",", "Red"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotLabel", "\[Rule]", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"\"\<Porosity = \>\"", ",", 
            RowBox[{"ToString", "[", 
             RowBox[{"porosity", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
         RowBox[{"BoxRatios", "\[Rule]", "Automatic"}], ",", " ", 
         RowBox[{"Axes", "\[Rule]", "True"}], ",", " ", 
         RowBox[{"Boxed", "\[Rule]", "True"}]}], "\[IndentingNewLine]", "]"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "[", "funcs", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"boundary", "=", 
     RowBox[{"Cylinder", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "zmin"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "zmax"}], "}"}]}], "}"}], ",", 
       "radius"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"functioncontour", "=", "\[IndentingNewLine]", 
     RowBox[{"ContourPlot3D", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fun", "\[Equal]", "0."}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[Element]", " ", 
        "boundary"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ContourStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"Opacity", "[", "0.99", "]"}], ",", "Blue"}], "]"}]}], ",", 
       RowBox[{"ViewPoint", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "Pi"}], ",", 
          RowBox[{"-", "Pi"}], ",", 
          RowBox[{"Pi", "*", "1.5"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Contours", "\[Rule]", 
        RowBox[{"{", "0", "}"}]}], ",", 
       RowBox[{"Mesh", "\[Rule]", "None"}], ",", 
       RowBox[{"RegionBoundaryStyle", "\[Rule]", "None"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"BoxRatios", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"Axes", "\[Rule]", "True"}], ",", 
       RowBox[{"Boxed", "\[Rule]", "True"}]}], "\[IndentingNewLine]", "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<cylTPMSd-\>\"", ",", 
         RowBox[{"ToString", "[", "ii", "]"}], ",", "\"\<.stl\>\""}], "]"}], 
       ",", 
       RowBox[{"cylTPMS", "[", 
        RowBox[{"[", "ii", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "[", "cylTPMS", "]"}]}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<cylTPMSd-\>\"", ",", 
         RowBox[{"ToString", "[", "ii", "]"}], ",", "\"\<.pdf\>\""}], "]"}], 
       ",", 
       RowBox[{"cylTPMS", "[", 
        RowBox[{"[", "ii", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"ii", ",", 
       RowBox[{"Length", "[", "cylTPMS", "]"}]}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"StringJoin", "[", 
      RowBox[{"\"\<cylTPMScont\>\"", ",", "\"\<-d\>\"", ",", "\"\<.stl\>\""}],
       "]"}], ",", "functioncontour"}], "]"}]}]}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 CellChangeTimes->{{3.8218744884626856`*^9, 3.821874490108684*^9}, {
   3.8218745242416844`*^9, 3.821874593428684*^9}, {3.821874754869337*^9, 
   3.8218747551153245`*^9}, {3.8218750234955797`*^9, 
   3.8218750341615467`*^9}, {3.8218752327019696`*^9, 
   3.8218752420611677`*^9}, {3.821875397107546*^9, 3.8218753984365473`*^9}, {
   3.8218757338046722`*^9, 3.8218757344356613`*^9}, {3.821875919522601*^9, 
   3.8218759485916014`*^9}, {3.8218759959982815`*^9, 
   3.8218760640169067`*^9}, {3.821876100736637*^9, 3.8218761779347634`*^9}, {
   3.821876209523437*^9, 3.8218762748199863`*^9}, {3.8218763872095137`*^9, 
   3.8218764130165854`*^9}, {3.8218767677776775`*^9, 3.82187677727521*^9}, {
   3.8218838961658354`*^9, 3.821883912902836*^9}, 3.8218844972518835`*^9, {
   3.821884557077883*^9, 3.8218845587426033`*^9}, 3.821885363163186*^9, {
   3.8218950169119987`*^9, 3.821895022246022*^9}, {3.8218959248894653`*^9, 
   3.8218959575145025`*^9}, {3.8218960161924663`*^9, 3.821896157046632*^9}, 
   3.8218961878256397`*^9, {3.8218963507706385`*^9, 3.8218964134776373`*^9}, {
   3.821896862174019*^9, 3.8218968765990186`*^9}, {3.8218970005750933`*^9, 
   3.821897005480093*^9}, {3.821897055586094*^9, 3.8218970593430967`*^9}, {
   3.8218971432011213`*^9, 3.821897193939093*^9}, {3.8218977501728125`*^9, 
   3.821897764506811*^9}, {3.8218977988173676`*^9, 3.8218978042193146`*^9}, {
   3.821897877320505*^9, 3.821897880788528*^9}, {3.821898099515436*^9, 
   3.821898106509444*^9}, {3.821898290943677*^9, 3.8218982933506684`*^9}, {
   3.821898689737253*^9, 3.8218986898682833`*^9}, {3.821940134532725*^9, 
   3.8219401441177244`*^9}, {3.822023048266965*^9, 3.8220230654426627`*^9}, {
   3.8220338181526723`*^9, 3.822033818232673*^9}, {3.822034160351827*^9, 
   3.822034162169145*^9}, {3.8223320889037914`*^9, 3.8223321267947526`*^9}, {
   3.822332510177253*^9, 3.822332523178224*^9}, {3.8223325722722225`*^9, 
   3.8223325948852243`*^9}, {3.822332896520006*^9, 3.8223329056320105`*^9}, 
   3.8223332639271617`*^9, 3.822333570535222*^9, 3.822333789010659*^9, {
   3.822333971710515*^9, 3.82233397879854*^9}, {3.822334456044538*^9, 
   3.8223344627285585`*^9}, {3.822335072748788*^9, 3.82233511711944*^9}, 
   3.82236341332922*^9, {3.8223637175587997`*^9, 3.822363720098797*^9}, {
   3.8223639086529975`*^9, 3.8223639571633387`*^9}, {3.822363998972376*^9, 
   3.8223640399913673`*^9}, 3.8223642692009983`*^9, {3.8223646963208847`*^9, 
   3.822364703272901*^9}, {3.822368065432886*^9, 3.8223680670518847`*^9}, {
   3.822368306346199*^9, 3.8223683110494432`*^9}, {3.822369641430986*^9, 
   3.822369642328985*^9}, {3.822369882722618*^9, 3.822369885758648*^9}, {
   3.822370134453638*^9, 3.822370141381461*^9}, 3.8223705431022034`*^9, {
   3.822370616085224*^9, 3.822370724450182*^9}, {3.8223707884871836`*^9, 
   3.8223707895672126`*^9}, {3.8223709492962213`*^9, 
   3.8223710221961837`*^9}, {3.822371118210142*^9, 3.822371233336235*^9}, {
   3.8223712782249203`*^9, 3.822371279415921*^9}, {3.822371355287012*^9, 
   3.822371355758972*^9}, {3.822371395945972*^9, 3.8223714018390007`*^9}, {
   3.8223715900990033`*^9, 3.8223716523579426`*^9}, {3.822371709844945*^9, 
   3.8223717164359426`*^9}, {3.8223717864561596`*^9, 
   3.8223718772432613`*^9}, {3.8223719253962665`*^9, 3.822371942225233*^9}, {
   3.8223719817802324`*^9, 3.8223720088702316`*^9}, {3.8223721474292355`*^9, 
   3.8223721583182936`*^9}, {3.8223728354182243`*^9, 3.822372894817263*^9}, {
   3.8223731093338976`*^9, 3.8223731845199294`*^9}, {3.822373281053952*^9, 
   3.822373327292013*^9}, {3.8223733827316074`*^9, 3.8223735524040723`*^9}, {
   3.8223735914220533`*^9, 3.822373594751052*^9}, {3.8223736255320816`*^9, 
   3.8223736419100523`*^9}, 3.8223738185350895`*^9, {3.8223739296423283`*^9, 
   3.8223739476212935`*^9}, 3.822375910234192*^9, {3.822377683883778*^9, 
   3.8223776842218466`*^9}, {3.8223800405947466`*^9, 3.822380055489781*^9}, {
   3.822380207500115*^9, 3.822380207679153*^9}, {3.822380296445128*^9, 
   3.8223803773746963`*^9}, {3.8223804588237357`*^9, 
   3.8223804761987567`*^9}, {3.822380564690699*^9, 3.822380617403717*^9}, {
   3.822380676198735*^9, 3.8223806849277353`*^9}, {3.8223807209967375`*^9, 
   3.822380725021698*^9}, {3.8223810843807354`*^9, 3.8223810876437054`*^9}, {
   3.8223816908795443`*^9, 3.822381691687544*^9}, {3.822382340662259*^9, 
   3.8223823413812714`*^9}, {3.822383617609753*^9, 3.822383619923776*^9}, {
   3.822385834649585*^9, 3.8223858388345747`*^9}, 3.8223862736965175`*^9, 
   3.8224129189249306`*^9, {3.8224132610845995`*^9, 3.8224132656287766`*^9}, {
   3.8224132973760605`*^9, 3.8224132982331095`*^9}, {3.822414828622324*^9, 
   3.822414843090307*^9}, {3.8224154423141165`*^9, 3.8224154802736115`*^9}, {
   3.822415543317973*^9, 3.822415546309658*^9}, {3.822415608725479*^9, 
   3.822415611560072*^9}, {3.8224157107834063`*^9, 3.822415717735783*^9}, 
   3.822415809275481*^9, {3.8224158705410476`*^9, 3.822415879717389*^9}, {
   3.822415977163825*^9, 3.8224159776800866`*^9}, {3.822416121411292*^9, 
   3.822416121664255*^9}, {3.822416202456827*^9, 3.8224162029058657`*^9}, {
   3.822416312262365*^9, 3.8224163246986203`*^9}, {3.8224164127879915`*^9, 
   3.8224164212929974`*^9}, {3.822416635644348*^9, 3.8224166450984983`*^9}, {
   3.8224167306225476`*^9, 3.8224168032059417`*^9}, {3.8224168804718037`*^9, 
   3.822416891114137*^9}, {3.8224169516173997`*^9, 3.8224169549922132`*^9}, {
   3.8224169956960096`*^9, 3.822417006741174*^9}, {3.8224171436779156`*^9, 
   3.8224171485569324`*^9}, {3.8224172512498226`*^9, 
   3.8224172697215605`*^9}, {3.8224173245334034`*^9, 
   3.8224173359642377`*^9}, {3.8224173750457582`*^9, 
   3.8224173760817213`*^9}, {3.8224174941393766`*^9, 3.822417499897397*^9}, {
   3.822417673510089*^9, 3.822417676322049*^9}, {3.82241840689837*^9, 
   3.82241842741848*^9}, {3.822418535171812*^9, 3.822418564217611*^9}, {
   3.8224186693383265`*^9, 3.822418704887393*^9}, {3.8224192743165627`*^9, 
   3.8224192857515564`*^9}, {3.822419332618559*^9, 3.822419362295558*^9}, 
   3.8224565919084253`*^9, {3.82245706944248*^9, 3.822457072869874*^9}, {
   3.8224580519800973`*^9, 3.82245812107806*^9}, 3.822458464184738*^9, {
   3.8224585010377398`*^9, 3.8224585032867775`*^9}, {3.8224586187136955`*^9, 
   3.822458619860696*^9}, {3.822458689970697*^9, 3.8224586902866993`*^9}, 
   3.822458853569829*^9, {3.822458891708813*^9, 3.822458893148777*^9}, 
   3.8224589331618195`*^9, {3.822459101749102*^9, 3.822459128388141*^9}, {
   3.822459243903104*^9, 3.8224592442421327`*^9}, {3.8224595890359783`*^9, 
   3.822459624379983*^9}, {3.8224599356005144`*^9, 3.8224599785305147`*^9}, {
   3.822460702727789*^9, 3.8224607047317905`*^9}, 3.8224623428677435`*^9, 
   3.822462414998578*^9, {3.8224625019633303`*^9, 3.8224625530392933`*^9}, {
   3.822462869997077*^9, 3.822462879964049*^9}, {3.822467152035796*^9, 
   3.8224671573217974`*^9}, {3.8224674333761616`*^9, 
   3.8224674334861917`*^9}, {3.822467967063902*^9, 3.822467967493929*^9}, {
   3.8224684386928816`*^9, 3.822468454754883*^9}, {3.8224695992769094`*^9, 
   3.822469599390908*^9}, {3.8224700796143484`*^9, 3.8224701256273303`*^9}, 
   3.8224701786433496`*^9, 3.82247148040007*^9, {3.8224717082133007`*^9, 
   3.822471708619303*^9}, {3.82247174360734*^9, 3.822471765453306*^9}, {
   3.824649185594984*^9, 3.8246492832609806`*^9}, {3.8246493335959806`*^9, 
   3.8246493388499823`*^9}, {3.8246494013869767`*^9, 3.824649468013981*^9}, {
   3.8246498773382854`*^9, 3.8246499031642857`*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"2375f059-0e8a-49e6-81ee-7e8dfe1100ad"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", "\<\"cylTPMSd-1.stl\"\>", "}"}]], "Output",
 CellChangeTimes->{3.824649909823287*^9, 3.824650846264628*^9},
 CellLabel->"Out[49]=",ExpressionUUID->"afe22105-ddba-43bb-889a-bda54e7913a3"],

Cell[BoxData[
 RowBox[{"{", "\<\"cylTPMSd-1.pdf\"\>", "}"}]], "Output",
 CellChangeTimes->{3.824649909823287*^9, 3.824650919559621*^9},
 CellLabel->"Out[50]=",ExpressionUUID->"9a6c8398-8cc0-4d49-aa08-a782dcaea2cc"],

Cell[BoxData["\<\"cylTPMScont-d.stl\"\>"], "Output",
 CellChangeTimes->{3.824649909823287*^9, 3.8246515697286243`*^9},
 CellLabel->"Out[51]=",ExpressionUUID->"44892f5b-50c3-445c-af0d-d7e67485a42f"]
}, Open  ]]
},
WindowSize->{1152., 585.6},
WindowMargins->{{-5.3999999999999995`, Automatic}, {-5.399999999999977, 
   Automatic}},
Magnification:>1.2 Inherited,
FrontEndVersion->"12.2 for Microsoft Windows (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"7c434372-98d3-47c0-ae04-bbadde742ca4"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 354, 5, 63, "Subtitle",ExpressionUUID->"08c1aa37-dece-409a-883a-d9d4505cfe99"],
Cell[CellGroupData[{
Cell[959, 31, 1027, 16, 43, "Input",ExpressionUUID->"6aba2b60-86f6-4f37-b4aa-91c1188190ae",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[1989, 49, 22057, 596, 1407, "Input",ExpressionUUID->"4c5abc6e-b35a-4ee3-87ee-f9c3427e4668",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Open  ]],
Cell[CellGroupData[{
Cell[24083, 650, 7956, 115, 115, "Input",ExpressionUUID->"745ccf46-2330-44b6-9d11-ec1428d321cc",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.}],
Cell[32042, 767, 17406, 353, 1127, "Input",ExpressionUUID->"2375f059-0e8a-49e6-81ee-7e8dfe1100ad",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.}]
}, Open  ]],
Cell[49463, 1123, 214, 3, 39, "Output",ExpressionUUID->"afe22105-ddba-43bb-889a-bda54e7913a3"],
Cell[49680, 1128, 214, 3, 39, "Output",ExpressionUUID->"9a6c8398-8cc0-4d49-aa08-a782dcaea2cc"],
Cell[49897, 1133, 197, 2, 39, "Output",ExpressionUUID->"44892f5b-50c3-445c-af0d-d7e67485a42f"]
}, Open  ]]
}
]
*)

